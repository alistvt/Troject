{% extends "base.html" %}
{% load staticfiles %}
{% block content %}

{% if user.is_superuser %}
<!-- NewItem Modal -->
<div id="new-item-modal" class="modal fade" role="dialog">
<div class="modal-dialog modal-md">

  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">&times;</button>
      <h4 class="modal-title"><span class="glyphicon glyphicon-plus"></span> New Task</h4>
    </div>
    <div class="modal-body">
      <form action="/action_page.php">
        {% csrf_token %}
        <div class="form-group">
          <label for="title">Title:</label>
          <input  class="form-control" id="email">
        </div>
        <div class="form-group">
          <label for="group">Group:</label>
          <select class="form-control" id="group">
            {% for val,name in groups %}
            <option name="group" value="{{val}}">{{name}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="form-group">
          <label for="users">User:</label>
          <select class="form-control" id="users">
            {% for user_ in users %}
            <option name="user" value="{{user_.id}}">{{user_.username}}</option>
            {% endfor %}
          </select>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
      <button type="button" class="btn btn-primary" data-dismiss="modal">Add Task</button>
    </div>
  </div>
</div>
</div>
{% endif %}


<!--==========   Tasks   ==========-->
<div class="container" style="margin-top:65px">
  <div class="row">

    <!--=====   Single Group Tasks (column)   =====-->
    {% for groupName, groupTasks in tasks.items %}

    <div class="col-md-3 col-sm-6 col-xs-12">
      <legend>{{groupName}}<span class="badge pull-right" style="position:relative; Top: 5px;">{{groupTasks|length}}</span></legend>

      <!--=======  Task (signle task)  =======-->
      {% for task in groupTasks %}

      <!--=======  Pending Tasks =======-->
      {% if not task.status %}
      <div class="panel panel-default">
        <div class="panel-heading">
          {{task.title}}
          <button type="button" class="pull-right btn-xs btn-success" data-toggle="modal" data-target="#done-modal-id"><span class="glyphicon glyphicon-ok"></span></button>
        </div>
        <div class="panel-body">
          {% if user.is_superuser %}
          <p><span class="glyphicon glyphicon-user"></span><span class="pull-right label label-default">{{task.user.username}}</span></p>
          {% endif %}
          <p><span class="glyphicon glyphicon-calendar"></span><span class="pull-right">{{task.createdDate}}</span></p>
          <button type="button" class="pull-right btn-xs btn-danger" data-toggle="modal" data-target="#delete-modal-{{task.id}}"><span class="glyphicon glyphicon-remove"></span></button>
        </div>

        <!-- Done Modal -->
        <div id="done-modal-{{task.id}}" class="modal fade" role="dialog">
        <div class="modal-dialog modal-sm">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Done Task?</h4>
            </div>
            <div class="modal-body">
              <p>Are you sure that task is done?!</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
              <button type="button" class="btn btn-success" data-dismiss="modal">Yes</button>
            </div>
          </div>
        </div>
        </div>

        <!-- Delete Modal -->
        <div class="modal-dialog modal-sm">
          <div id="delete-modal-{{task.id}}" class="modal fade" role="dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title"><span style="color:#F00">Delete</span> Task?</h4>
            </div>
            <div class="modal-body">
              <p>Are you sure to delete this task?!</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
              <button type="button" class="btn btn-success" data-dismiss="modal">Yes</button>
            </div>
          </div>
        </div>
        </div>
      </div>

      <!--=======  Done Tasks =======-->
      {% else %}
      <div class="panel panel-success">
        <div class="panel-heading">{{task.title}}<span class="pull-right glyphicon glyphicon-ok"></span></div>
        <div class="panel-body">
          {% if user.is_superuser %}
          <p><span class="glyphicon glyphicon-user"></span><span class="pull-right label label-default">{{task.user.username}}</span></p>
          {% endif %}
          <p><span class="glyphicon glyphicon-calendar"></span><span class="pull-right">{{task.createdDate}}</span></p>
          <p><span class="glyphicon glyphicon-check"></span><span class="pull-right">{{task.doneDate}}</span></p>
        </div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
    {% endfor %}

  </div>
</div>


{% endblock %}
